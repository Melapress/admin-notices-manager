"use strict";!function(l){({container:null,counter_link:null,migration_delay:100,migration_interval:null,migration_start:0,migration_limit:5e3,popup_delay:50,popup_interval:null,popup_start:0,popup_limit:1e3,removal_interval:null,system_messages:[],init:function(){var t=this;l("body").append('<div id="anm-container" style="display: none;"></div>'),this.container=l("#anm-container"),this.counter_link=l("#wp-admin-bar-anm_notification_count"),this.init_triggers(),this.migration_start=(new Date).getTime(),this.migration_interval=setInterval(function(){t.transfer_notices()},this.migration_delay);for(var n=anm_i18n.system_messages.length,e=0;e<n;e++){var i=anm_i18n.system_messages[e];this.system_messages.push(i.replace(/%[sdf]/g,""))}},get_current_counter_value:function(){var t=l(".anm-notification-counter span.count");return 0==t.length?0:parseInt(t.html(),10)},get_notice_type:function(t){var n=l(t);return n.hasClass("notice-system")?"system":n.hasClass("notice-error")?"error":n.hasClass("notice-info")?"information":n.hasClass("notice-warning")?"warning":n.hasClass("notice-success")||n.hasClass("updated")?"success":"no"},check_migration_interval:function(){(new Date).getTime()-this.migration_start>this.migration_limit&&(clearInterval(this.migration_interval),this.migration_interval=null,console.log("migration interval cleared"))},transfer_notices:function(){var r=this,t=l("#wpbody-content .wrap").children("div.updated, div.error, div.notice, #message").not(".hidden");t.each(function(t,n){for(var e=r.system_messages.length,i=0;i<e;i++){var a=r.system_messages[i];0<n.innerHTML.indexOf(a)&&l(n).addClass("notice-system")}});var o=0,s=this.container;t.each(function(t,n){var e=r.get_notice_type(n),i="system"===e?"wordpress_system_admin_notices":e+"_level_notices",a=anm_i18n.settings[i];"hide"===a?l(n).remove():"popup-only"===a&&(l(n).detach().appendTo(s),o++)});var n=o;0<l(".anm-notification-counter").length&&(n+=this.get_current_counter_value()),this.updateCounterBubble(n),this.check_migration_interval()},updateCounterBubble:function(t){var n,e;0<l(".anm-notification-counter").length?l(".anm-notification-counter span.count").html(t):(n=anm_i18n.title,this.counter_link.find("a").html(n),e='<div class="anm-notification-counter wp-core-ui wp-ui-notification"><span aria-hidden="true" class="count">'+t+'</span><span class="screen-reader-text">'+t+" "+n+"</span></div>",this.counter_link.attr("data-popup-title",n),this.counter_link.find("a").append(e),this.counter_link.addClass("has-data"))},adjust_modal_height:function(){l("#TB_ajaxContent").css({width:"100%",height:l("#TB_window").height()-l("#TB_title").outerHeight()-22+"px",padding:"2px 0px 20px 0px"}),this.popup_interval&&(new Date).getTime()-this.popup_start>this.popup_limit&&(clearInterval(this.popup_interval),this.popup_interval=null)},checkNoticeRemoval:function(){var t,n;l("#TB_ajaxContent").height()?(t=l("#TB_ajaxContent").children().not(":hidden").length,n=this.get_current_counter_value(),console.log("checkNoticeRemoval",t,n),n!==t&&this.updateCounterBubble(t)):this.removal_interval&&clearInterval(this.removal_interval)},init_triggers:function(){var t=this;this.counter_link.click(function(){return t.popup_interval&&(clearInterval(t.popup_interval),t.popup_interval=null),0==t.get_current_counter_value()||(tb_show(t.counter_link.attr("data-popup-title"),"#TB_inline?inlineId=anm-container"),t.popup_start=(new Date).getTime(),t.popup_interval=setInterval(function(){t.adjust_modal_height.call(t)},t.popup_delay),t.removal_interval&&clearInterval(t.removal_interval),t.removal_interval=setInterval(function(){t.checkNoticeRemoval.call(t)},t.popup_delay)),!1}),l(window).resize(function(){t.adjust_modal_height.call(t)})}}).init()}(jQuery);